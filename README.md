# Crew Sizing and Scheduling Solution to Minimize Cost and Time of Rework in Prefabricated Construction

# Introduction

This study presented a new method to minimize the cost and time of rework due to fabrication and assembly errors in prefabricated construction (or module fabrication plants) considering the spatial relationship between elements. The time required to remedy the element’s error was used as the basis to find optimal crew sizing and scheduling to minimize the cost of labour as well as overhead. The following image shows the different elements that depending on their tolerance violation require rehabilitation.

![image](https://github.com/user-attachments/assets/a23dfe44-4e16-4b4d-a874-aa300957b74f)

To account for the variations in time demand for different elements, the required time was modeled as a function–log-linear model–of: (i) element assembly error, estimated as the difference between the actual and planned locations through automatic processing of laser scanner point clouds; (ii) element importance and size from the planned building information modeling (BIM); (iii) available space from planned (or actual) site layout; and (iv) number of assigned crews. Using this information, a standardized time demand zoning map can be generated as the basis to find the optimal crew sizing and scheduling. The following image shows the designated time demand for each of the elements requiring rehabilitation work.  

![image](https://github.com/user-attachments/assets/e7d69dea-6b64-4dc8-b11c-fd61e2f79af0)


# Problem Formulation and Solution

Using the time demand model, new formulations were derived to: (i) incorporate the spatial constraints between zones through a new quadratic constraint (Constraint (6) below shown in green); (ii) account for the uncertainty in the modeled time demand through hypograph relaxation in robust optimization (Constraint (5) bellow represented with the addition of the blue term); and (iii) include a linear penalty term to balance work demand within zones to achieve Takt (Objective function below incorporated with the red term). These problems were formulated as a mixed integer linear programming (MILP) without the spatial constraint, and mixed integer quadratically constrained programming (MIQCP) with the spatial constraint for the crew sizing and scheduling problem.
![image](https://github.com/user-attachments/assets/58f456c5-489a-47ca-ab10-d729d4464c03)
where the objective function seeks to minimize the total cost, which consists of three components: 
- **Operation Costs \( Cc \)**: The cost per crew associated with operations.
- **Overhead Costs \( Co \)**: The cost of overhead per unit of time.
- **Takt Costs \( Ct \)**: The cost of violating the work balancing between different zones. 

# Implementation and Dependencies

The code was implemented in Matlab and solved using the Gurobi integer programming (v. 12.0.0). As such, in order to utilize the code, the user must install the following in addition to an up-to-date Matlab software:

1- Gurobi Solver for Matlab to solve the MILP and MIQCP problems

2- "hatchfill2" function found under the following repository: https://github.com/hokiedsp/matlab-hatchfill2.git

# Results of the Study

The code provides the user with the opportunity to change the costs, resource demand at each time quantile, target duration, and maximum crews per element. Once these are set within the "Main Code", the user can then execute the main code. Once complete, the following plot can be generated by executing the "Plotting-Crew Sizing and Scheduling" script.

![image](https://github.com/user-attachments/assets/2997ce6c-c171-46d7-9398-ce315269a5c4)


# Explanation on Code and Provided Files


As part of this Repository, three folders are provided:

1- Inputs, which includes the required input data, such as mesh model of each element (in .stl format) and input matrices (e.g., Distance matrix for spatial constraints).

2- Dependent Functions, which includes the newly developed functions called in the main script, along with some supporting functions (e.g., to read .stl files).

3- Demonstration, which includes the main script along with the code for the general plotting.

To successfully run the code, all items must be accessible to Matlab at the time of execution.


# Citation
The study is planned to be published in the proceedings of the 33rd Conference of the International Group for Lean Construction (IGLC), where the mathematical formulations are explained in more detail. You may cite the study using the following information:

R. Maalek (2025). New Mixed Integer Programming Formulation for the Simultaneous Minimization of Cost and Time of Rework due to On-site Assembly Errors in Prefabricated Construction. In O. Seppänen, L. Koskela, & K. Murata (Eds.), Proceedings of the 33rd Annual Conference of the International Group for Lean Construction (IGLC33), Osaka and Kyoto, Japan, June 2025.

# Acknowledgements
The author wishes to acknowledge the generous endowment provided by GOLDBECK GmbH to the Karlsruhe Institute of Technology (KIT) for the establishment of the Professorship in Digital Engineering and Construction at the Institute of Technology and Management in Construction (TMB).
